module.exports=function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.StructureMap=class{constructor(t){this.sourcemap=[],t.find(FIND_SOURCES).forEach(t=>{this.sourcemap.push(new o(t))})}};class o{constructor(t){this.spaces=0,this.pos=t.pos;var e=this.pos.x-1,r=this.pos.x+1,o=this.pos.y-1,n=this.pos.y+1;for(let a=e;a<=r;a++)for(let e=o;e<=n;e++){var s=t.room.lookAt(a,e);"terrain"==s[0].type&&"wall"!=s[0].terrain&&(this.spaces+=1)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.RoomMem=class{constructor(t){this.pathsSet=!1,this.containersSet=!1,this.StructMap=t.StructMap,this.pathSets=[]}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(1),n=r(0);function s(t){var e=new o.RoomMem(t.memory);e.StructMap||(console.log("Setting up structure map for room: ",t.name),e.StructMap=new n.StructureMap(t),t.memory=e)}function a(t){var e=t.find(FIND_MY_SPAWNS)[0],r=t.memory;if(r.StructMap.sourcemap.forEach(o=>{var n=t.findPath(o.pos,e.pos);r.pathSets.push(n),n.forEach(e=>{t.createConstructionSite(e.x,e.y,STRUCTURE_ROAD)})}),t.controller){var o=t.controller,n=t.findPath(e.pos,o.pos);r.pathSets.push(n),n.forEach(e=>{t.createConstructionSite(e.x,e.y,STRUCTURE_ROAD)})}t.memory=r}function i(t){console.log("Creatting containers...");t.find(FIND_MY_SPAWNS)[0];console.log("Got Paths"),console.log(JSON.stringify(t.memory)),t.memory.pathSets&&t.memory.pathSets.forEach(e=>{console.log("path: ",e);var r=e.splice(1,e.length-2);for(let e=0;e<r.length;e++){var o=u(r[e],t);if(o){t.createConstructionSite(o.x,o.y,STRUCTURE_CONTAINER);break}}})}function u(t,e){var r=t.x-1,o=t.x+1,n=t.y-1,s=t.y+1,a=null,i=e.lookAtArea(n,r,s,o,!1);for(var u in console.log("Area: ",JSON.stringify(i)),i){var c=i[u];for(var l in c)if(1==i[u][l].length&&"wall"!=i[u][l].terrain){a={x:parseInt(l),y:parseInt(u)},console.log("Selected spot: ",JSON.stringify(a));break}break}return a}function c(t){return t.memory}e.Setup=function(){for(var t in Game.rooms){var e=Game.rooms[t];let r=c(e);r.pathsSet&&!r.containersSet&&(r=c(e),i(e),r.containersSet=!0,e.memory=r),r.pathsSet||(s(e),a(e),(r=c(e)).pathsSet=!0,e.memory=r)}}},function(t,e,r){"use strict";var o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(2));e.loop=function(){n.Setup()}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Jvb21NYW5hZ2VyL1Jvb21NYW5hZ2VyTW9kZWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9HbG9iYWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Jvb21NYW5hZ2VyL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiU3RydWN0dXJlTWFwIiwiW29iamVjdCBPYmplY3RdIiwicm9vbSIsInRoaXMiLCJzb3VyY2VtYXAiLCJmaW5kIiwiRklORF9TT1VSQ0VTIiwiZm9yRWFjaCIsInNvdXJjZSIsInB1c2giLCJTb3VyY2VJbmZvIiwic3BhY2VzIiwicG9zIiwibGVmdCIsIngiLCJyaWdodCIsInRvcCIsInkiLCJib3QiLCJzcG90IiwibG9va0F0IiwidHlwZSIsInRlcnJhaW4iLCJSb29tTWVtIiwiZGF0YSIsInBhdGhzU2V0IiwiY29udGFpbmVyc1NldCIsIlN0cnVjdE1hcCIsInBhdGhTZXRzIiwiR2xvYmFsXzEiLCJSb29tTWFuYWdlck1vZGVsc18xIiwiQ3JlYXRlU3RydWN0dXJlTWFwIiwicm9vbU1lbSIsIm1lbW9yeSIsImNvbnNvbGUiLCJsb2ciLCJDcmVhdGVTdGFydGluZ1BhdGhzIiwic3Bhd24iLCJGSU5EX01ZX1NQQVdOUyIsInJtIiwicGF0aCIsImZpbmRQYXRoIiwicG9zaXRpb24iLCJjcmVhdGVDb25zdHJ1Y3Rpb25TaXRlIiwiU1RSVUNUVVJFX1JPQUQiLCJjb250cm9sbGVyIiwiY3RyIiwiQ3JlYXRlUGF0aENvbnRhaW5lcnMiLCJKU09OIiwic3RyaW5naWZ5Iiwic3ViUGF0aCIsInNwbGljZSIsImxlbmd0aCIsImVtcHR5IiwiQ2hlY2tTdXJyb3VuZGluZ3MiLCJTVFJVQ1RVUkVfQ09OVEFJTkVSIiwibG9jYXRpb24iLCJhcmVhIiwibG9va0F0QXJlYSIsInlrZXkiLCJ5Q29sIiwieGtleSIsInBhcnNlSW50IiwiR2V0Um9vbU1lbSIsIlNldHVwIiwiR2FtZSIsInJvb21zIiwiUk0iLCJfX2ltcG9ydFN0YXIiLCJsb29wIl0sIm1hcHBpbmdzIjoiMkJBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQTBEQSxPQXJEQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFB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NkMsU0FBU0gsSUFDeEN6QixRQUFRQyxJQUFJLGtCQUFtQmEsS0FBS0MsVUFBVU8sSUFDOUMsTUFHUixNQUlKLE9BQU9BLEVBR1gsU0FBQU8sRUFBb0I3RCxHQUNqQixPQUFRQSxFQUFLK0IsT0E5R2hCbkUsRUFBQWtHLE1BQUEsV0FDSSxJQUFLLElBQUl6RSxLQUFPMEUsS0FBS0MsTUFBTyxDQUN4QixJQUFJaEUsRUFBTytELEtBQUtDLE1BQU0zRSxHQUN0QixJQUFJeUMsRUFBVStCLEVBQVc3RCxHQUV0QjhCLEVBQVFQLFdBQWFPLEVBQVFOLGdCQUM1Qk0sRUFBVStCLEVBQVc3RCxHQUNyQjZDLEVBQXFCN0MsR0FDckI4QixFQUFRTixlQUFnQixFQUN4QnhCLEVBQUsrQixPQUFTRCxHQUdkQSxFQUFRUCxXQUNSTSxFQUFtQjdCLEdBQ25Ca0MsRUFBb0JsQyxJQUNwQjhCLEVBQVUrQixFQUFXN0QsSUFDYnVCLFVBQVcsRUFDbkJ2QixFQUFLK0IsT0FBU0QsaVFDdEIxQixNQUFBbUMsRUFBQUMsRUFBQXhHLEVBQUEsSUFFYUUsRUFBQXVHLEtBQU8sV0FFWkYsRUFBR0giLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAzKTtcbiIsIlxyXG5leHBvcnQgY2xhc3MgU3RydWN0dXJlTWFwe1xyXG4gICAgc291cmNlbWFwOlNvdXJjZUluZm9bXSA9IFtdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogY3JlYXRlcyBhIG1hcCBvZiB0aGUgbmF0dXJlYWwgc3RydWN0dXJlcyBpbiB0aGUgcm9vbSBvbiBzdGFydHVwXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHJvb206IFJvb20pIHtcclxuICAgICAgICB2YXIgc291cmNlcyA9IHJvb20uZmluZChGSU5EX1NPVVJDRVMpO1xyXG4gICAgICAgIHNvdXJjZXMuZm9yRWFjaChzb3VyY2UgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZW1hcC5wdXNoKG5ldyBTb3VyY2VJbmZvKHNvdXJjZSkpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFNvdXJjZUluZm97XHJcbiAgICBwb3M6Um9vbVBvc2l0aW9uO1xyXG4gICAgc3BhY2VzOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogcXVpY2sgYWNjZXNzIG9iamVjdCBmb3Igc291cmNlc1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2U6IFNvdXJjZSkge1xyXG4gICAgICAgIHRoaXMucG9zID0gc291cmNlLnBvcztcclxuICAgICAgICB2YXIgbGVmdCA9IHRoaXMucG9zLnggLTE7XHJcbiAgICAgICAgdmFyIHJpZ2h0ID0gdGhpcy5wb3MueCArIDE7XHJcbiAgICAgICAgdmFyIHRvcCA9IHRoaXMucG9zLnkgLSAxO1xyXG4gICAgICAgIHZhciBib3QgPSB0aGlzLnBvcy55ICsgMTtcclxuICAgICAgICAvLyBsb29wIHRocm91Z2ggcG9zaXRpb25zIGFyb3VuZCBzb3VyY2UgYW5kIGNoZWNrIGZvciBlbXB0eSBzcGFjZXNcclxuICAgICAgICBmb3IgKGxldCB4ID0gbGVmdDsgeCA8PSByaWdodDsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSB0b3A7IHkgPD0gYm90OyB5KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzcG90ID0gc291cmNlLnJvb20ubG9va0F0KHgseSk7XHJcbiAgICAgICAgICAgICAgICBpZihzcG90WzBdLnR5cGUgPT0gXCJ0ZXJyYWluXCIgJiYgc3BvdFswXS50ZXJyYWluICE9IFwid2FsbFwiKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwYWNlcyArPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG4iLCJpbXBvcnQgeyBTdHJ1Y3R1cmVNYXAgfSBmcm9tIFwiLi9Sb29tTWFuYWdlci9Sb29tTWFuYWdlck1vZGVsc1wiO1xyXG5cclxuXHJcbmV4cG9ydCBtb2R1bGUgR2xvYmFse1xyXG4gICAgXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSb29tTWVte1xyXG4gICAgcGF0aHNTZXQ6Ym9vbGVhbiA9ZmFsc2U7XHJcbiAgICBjb250YWluZXJzU2V0OmJvb2xlYW4gPSBmYWxzZTtcclxuICAgIFN0cnVjdE1hcDpTdHJ1Y3R1cmVNYXA7XHJcbiAgICBwYXRoU2V0czogUGF0aFN0ZXBbXVtdXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IFJvb21NZW1vcnkpIHtcclxuICAgICAgICB0aGlzLlN0cnVjdE1hcCA9IGRhdGEuU3RydWN0TWFwO1xyXG4gICAgICAgIHRoaXMucGF0aFNldHMgPSBbXTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBHbG9iYWwsIFJvb21NZW0gfSBmcm9tICcuLi9HbG9iYWwnO1xyXG5pbXBvcnQgeyBTdHJ1Y3R1cmVNYXAgfSBmcm9tICcuL1Jvb21NYW5hZ2VyTW9kZWxzJztcclxuaW1wb3J0ICogYXMgXyBmcm9tIFwibG9kYXNoXCI7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIFNldHVwKCl7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gR2FtZS5yb29tcykge1xyXG4gICAgICAgIHZhciByb29tID0gR2FtZS5yb29tc1trZXldO1xyXG4gICAgICAgIGxldCByb29tTWVtID0gR2V0Um9vbU1lbShyb29tKTtcclxuXHJcbiAgICAgICAgaWYocm9vbU1lbS5wYXRoc1NldCAmJiAhcm9vbU1lbS5jb250YWluZXJzU2V0KXtcclxuICAgICAgICAgICAgcm9vbU1lbSA9IEdldFJvb21NZW0ocm9vbSk7XHJcbiAgICAgICAgICAgIENyZWF0ZVBhdGhDb250YWluZXJzKHJvb20pO1xyXG4gICAgICAgICAgICByb29tTWVtLmNvbnRhaW5lcnNTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICByb29tLm1lbW9yeSA9IHJvb21NZW07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighcm9vbU1lbS5wYXRoc1NldCl7XHJcbiAgICAgICAgICAgIENyZWF0ZVN0cnVjdHVyZU1hcChyb29tKTtcclxuICAgICAgICAgICAgQ3JlYXRlU3RhcnRpbmdQYXRocyhyb29tKTtcclxuICAgICAgICAgICAgcm9vbU1lbSA9IEdldFJvb21NZW0ocm9vbSk7XHJcbiAgICAgICAgICAgIHJvb21NZW0ucGF0aHNTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICByb29tLm1lbW9yeSA9IHJvb21NZW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIENyZWF0ZVN0cnVjdHVyZU1hcChyb29tOiBSb29tKXtcclxuICAgIHZhciByb29tTWVtID0gIG5ldyBSb29tTWVtKHJvb20ubWVtb3J5KTtcclxuICAgIGlmKCFyb29tTWVtLlN0cnVjdE1hcCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIHVwIHN0cnVjdHVyZSBtYXAgZm9yIHJvb206IFwiLCByb29tLm5hbWUpO1xyXG4gICAgICAgIHJvb21NZW0uU3RydWN0TWFwID0gbmV3IFN0cnVjdHVyZU1hcChyb29tKTtcclxuICAgICAgICByb29tLm1lbW9yeSA9IHJvb21NZW07XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIENyZWF0ZVN0YXJ0aW5nUGF0aHMocm9vbTogUm9vbSl7XHJcbiAgICB2YXIgc3Bhd24gPSByb29tLmZpbmQoRklORF9NWV9TUEFXTlMpWzBdO1xyXG4gICAgdmFyIHJtID0gKHJvb20ubWVtb3J5IGFzIFJvb21NZW0pO1xyXG4gICAgcm0uU3RydWN0TWFwLnNvdXJjZW1hcC5mb3JFYWNoKHNvdXJjZSA9PiB7XHJcbiAgICAgICAgdmFyIG9wdHM6IEZpbmRQYXRoT3B0cyAgPSB7fTtcclxuICAgICAgICB2YXIgcGF0aCA9IHJvb20uZmluZFBhdGgoc291cmNlLnBvcyAsc3Bhd24ucG9zKVxyXG4gICAgICAgIHJtLnBhdGhTZXRzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgcGF0aC5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgcm9vbS5jcmVhdGVDb25zdHJ1Y3Rpb25TaXRlKHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIFNUUlVDVFVSRV9ST0FEKTtcclxuICAgICAgICB9KTsgICAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYocm9vbS5jb250cm9sbGVyKXtcclxuICAgICAgICB2YXIgY3RyID0gKHJvb20uY29udHJvbGxlciBhcyBTdHJ1Y3R1cmVDb250cm9sbGVyKTtcclxuICAgICAgICB2YXIgcGF0aCA9IHJvb20uZmluZFBhdGgoc3Bhd24ucG9zLCBjdHIucG9zIClcclxuICAgICAgICBybS5wYXRoU2V0cy5wdXNoKHBhdGgpO1xyXG4gICAgICAgIHBhdGguZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgIHJvb20uY3JlYXRlQ29uc3RydWN0aW9uU2l0ZShwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBTVFJVQ1RVUkVfUk9BRCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByb29tLm1lbW9yeSA9IHJtO1xyXG59XHJcblxyXG5mdW5jdGlvbiBDcmVhdGVQYXRoQ29udGFpbmVycyhyb29tOiBSb29tKXtcclxuICAgIGNvbnNvbGUubG9nKFwiQ3JlYXR0aW5nIGNvbnRhaW5lcnMuLi5cIilcclxuICAgIHZhciBzcGF3biA9IHJvb20uZmluZChGSU5EX01ZX1NQQVdOUylbMF07XHJcbiAgICBjb25zb2xlLmxvZyhcIkdvdCBQYXRoc1wiKVxyXG4gICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoKHJvb20ubWVtb3J5IGFzIFJvb21NZW0pKSlcclxuICAgIGlmKChyb29tLm1lbW9yeSBhcyBSb29tTWVtKS5wYXRoU2V0cyl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgKHJvb20ubWVtb3J5IGFzIFJvb21NZW0pLnBhdGhTZXRzLmZvckVhY2gocGF0aCA9PiB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhdGg6IFwiLCBwYXRoKVxyXG4gICAgICAgICAgICB2YXIgc3ViUGF0aCA9IHBhdGguc3BsaWNlKDEscGF0aC5sZW5ndGggLTIpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN1YlBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNwb3QgPSBzdWJQYXRoW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVtcHR5ID0gQ2hlY2tTdXJyb3VuZGluZ3Moc3BvdCxyb29tKTtcclxuICAgICAgICAgICAgICAgIGlmKGVtcHR5KXtcclxuICAgICAgICAgICAgICAgICAgICByb29tLmNyZWF0ZUNvbnN0cnVjdGlvblNpdGUoZW1wdHkueCxlbXB0eS55LFNUUlVDVFVSRV9DT05UQUlORVIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuZnVuY3Rpb24gQ2hlY2tTdXJyb3VuZGluZ3MocG9zOiBQYXRoU3RlcCwgcm9vbTogUm9vbSl7XHJcbiAgICB2YXIgbGVmdCA9IHBvcy54IC0xO1xyXG4gICAgdmFyIHJpZ2h0ID0gcG9zLnggKyAxO1xyXG4gICAgdmFyIHRvcCA9IHBvcy55IC0gMTtcclxuICAgIHZhciBib3QgPSBwb3MueSArIDE7XHJcbiAgICBcclxuICAgIHZhciBsb2NhdGlvbiA9IG51bGw7XHJcbiAgICB2YXIgYXJlYSA9IHJvb20ubG9va0F0QXJlYSh0b3AsbGVmdCxib3QscmlnaHQsZmFsc2UpO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhcIkFyZWE6IFwiLEpTT04uc3RyaW5naWZ5KGFyZWEpKVxyXG4gICAgZm9yICh2YXIgeWtleSBpbiBhcmVhKXtcclxuICAgICAgICB2YXIgeUNvbCA9IGFyZWFbeWtleV07XHJcbiAgICAgICAgZm9yKHZhciB4a2V5IGluIHlDb2wpe1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBpZihhcmVhW3lrZXldW3hrZXldLmxlbmd0aD09MSYmKGFyZWFbeWtleV1beGtleV0gYXMgYW55KS50ZXJyYWluICE9IFwid2FsbFwiKXtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uID0ge3g6cGFyc2VJbnQoeGtleSkseTpwYXJzZUludCh5a2V5KX1cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VsZWN0ZWQgc3BvdDogXCIsIEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKSlcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgcmV0dXJuIGxvY2F0aW9uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBHZXRSb29tTWVtKHJvb206IFJvb20pe1xyXG4gICByZXR1cm4gKHJvb20ubWVtb3J5IGFzIFJvb21NZW0pO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJNIGZyb20gXCIuL1Jvb21NYW5hZ2VyL2luZGV4XCJcclxuXHJcbmV4cG9ydCBjb25zdCBsb29wID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgUk0uU2V0dXAoKTtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=